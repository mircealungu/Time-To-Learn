define("time",[],function(){function e(){var e;try{e=tizen.time.getCurrentDateTime()}catch(t){console.error("Error: ",t.message)}return e}function t(e){return 10>e&&(e="0"+e),e}var n,o,r,i,l,a,c;return{create:function(){n=e(),o=n.getFullYear(),r=t(n.getDate()),i=t(n.getMonth()+1),l=t(n.getHours()),a=t(n.getMinutes()),c=t(n.getSeconds())},getTimestamp:function(){return o+"-"+i+"-"+r+"T"+l+":"+a+":"+c},getDay:function(){return r},getHours:function(){return l},getMinutes:function(){return a}}}),define("events",["time"],function(e){var t="https://zeeguu.unibe.ch/upload_smartwatch_events",n=[],o=0;return{add:function(t,r){e.create(),n[o++]={bookmark_id:r,time:e.getTimestamp(),event:t}},save:function(){if(null!==localStorage.getItem("events")){var e=JSON.parse(localStorage.getItem("events"));console.log("currently in local storage: "+JSON.stringify(e)),console.log("saving..."),localStorage.setItem("events",JSON.stringify(e.concat(n)));var t=JSON.parse(localStorage.getItem("events"));console.log("events saved: "+JSON.stringify(t))}else console.log("currently no events in storage"),console.log("saving..."),localStorage.setItem("events",JSON.stringify(n)),console.log("events saved: "+JSON.stringify(n))},load:function(){null!==localStorage.getItem("events")&&(n=JSON.parse(localStorage.getItem("events")),console.log("loaded events: "+JSON.stringify(n)))},send:function(e){var n=new FormData,o=JSON.parse(localStorage.getItem("events"));console.log("trying to send these events:"+JSON.stringify(o)),n.append("events",JSON.stringify(o));var r=new XMLHttpRequest;r.open("POST",t+"?session="+e,!0),r.onload=function(){console.log("events uploaded to db: "+this.responseText),"OK"===this.responseText&&(console.log("removing events localStorage.."),localStorage.removeItem("events"),console.log("events in storage: "+localStorage.getItem("events")))},r.send(n)},print:function(){console.log(JSON.stringify(n))},clear:function(){n=[],o=0}}}),define("userData",["events"],function(e){var t,n=5,o=[],r=[],i=[0,1,2,3,4],l=5,a=0,c=0,s=0,d=!1;return{setWordPair:function(e,t,n,r){o[e]={word:t,translation:n,id:r}},getWordPair:function(e){return o[e]},areThereWords:function(){return o.length>0?!0:!1},flashCardMethod:function(e){e?(i[a]=n,a++,this.nextWord()):a++,a===NUMBER_OF_FLASH_CARDS&&(a=0)},initializeIntervals:function(){var e,n=0;for(e=0;t>n;e++)r[e]=n,n+=5;r[e]=t,console.log("intervals: "+r)},improvedFlashCardMethod:function(e){console.log("length: "+o.length),e?n===r[c+2]?(i.splice(a,1),l--,0===l&&(n===t?(c=0,n=5,i=[0,1,2,3,4],l=5,a=0):(c++,i=[r[c],r[c]+1,r[c]+2,r[c]+3,r[c]+4],l=5,n=r[c+1],a=0)),console.log("wN: "+n)):(i[a]=n,console.log("practice words from "+r[c]+" to "+r[c+2]+" | wN = "+n),n++,a++):a++,a>=l&&(a=0),console.log(l+" flashcards: "+i+" | shown word: "+i[a]+" index: "+a)},getWord:function(){return d?o[i[a]].translation:(console.log("index in wordPair: "+i[a]),o[i[a]].word)},removeWord:function(){return t>10?(o.splice(i[a],1),t--,!0):!1},getTranslation:function(){return d?o[i[a]].word:o[i[a]].translation},load:function(){console.log("loading userdata.."),0===localStorage.length?console.log("No user data available."):(s=localStorage.getItem("accountCode"),console.log("loaded accountCode: "+s),e.load(),null!==localStorage.getItem("wordNumber")&&(n=localStorage.getItem("wordNumber"),console.log("loaded wordNumber: "+n)),null!==localStorage.getItem("index")&&(a=localStorage.getItem("index"),console.log("loaded index: "+a)),null!==localStorage.getItem("indexInterval")&&(c=localStorage.getItem("indexInterval"),console.log("loaded indexInterval: "+c)),null!==localStorage.getItem("numberOfFlashcards")&&(l=localStorage.getItem("numberOfFlashcards"),console.log("loaded numberOfFlashcards: "+l)),null!==localStorage.getItem("flashcardsToShow")&&(i=JSON.parse(localStorage.getItem("flashcardsToShow")),console.log("loaded flashcards: "+i)),null!==localStorage.getItem("wordPair")&&(o=JSON.parse(localStorage.getItem("wordPair")),console.log("loaded wordpairs: "+JSON.stringify(o))))},saveCode:function(e){s=e,localStorage.setItem("accountCode",s),console.log("accountCode saved: "+localStorage.getItem("accountCode"))},saveWordPair:function(){localStorage.setItem("wordPair",JSON.stringify(o)),console.log(localStorage.getItem("wordPair"))},saveEvents:function(){e.print(),e.save(),e.clear()},saveCurrentState:function(){localStorage.setItem("wordNumber",n),4===a?localStorage.setItem("index",0):localStorage.setItem("index",a+1),localStorage.setItem("flashcardsToShow",JSON.stringify(i)),localStorage.setItem("indexInterval",c),localStorage.setItem("numberOfFlashcards",l)},sendEvents:function(){try{e.send(s)}catch(t){console.log("Error during sending: "+t)}},save:function(){if("localStorage"in window){if(localStorage.setItem("accountCode",s),console.log("accountCode saved: "+s),localStorage.setItem("wordNumber",n),console.log("wordNumber saved: "+n),e.print(),e.save(),e.clear(),e.readyToSend()){console.log("ready to send...");try{e.send(s)}catch(t){console.log("Error during sending: "+t)}}}else console.log("no localStorage in window")},addEvent:function(t){console.log("wordNumber is "+i[a]),e.add(t,o[i[a]].id)},getCode:function(){return s},setCode:function(e){s=e},getNumberOfWords:function(){return t},initNumberOfWords:function(){t=o.length},printWords:function(){console.log(JSON.stringify(o))},getWordNumber:function(){return n},setWordNumber:function(e){n=e},nextWord:function(){n++,n===t&&(n=0)},getReverseStatus:function(){return d},setReverseStatus:function(e){d=e},printEvents:function(){e.print()},clear:function(){localStorage.clear()}}}),define("login",["userData"],function(e){function t(){var e,t;e=document.getElementById("loginPage"),t=document.getElementById("mainPage"),e.style.display="none",t.style.display="block"}function n(e,t){f=document.getElementById("digitSpace"),m=f.getContext("2d"),m.clearRect(N+B*(e-1),0,B,O),m.font="80px Arial",m.fillStyle="black",m.textAlign="center",m.fillText(t,C+B*(e-1),k)}function o(e,t,o){return t?(o++,o>9&&(o=0)):(o--,0>o&&(o=9)),n(e,o),o}function r(e){f=document.getElementById("loginPopup"),f.style.visibility="visible",f=document.getElementById("loginPopupSpace"),m=f.getContext("2d"),m.clearRect(0,0,I,h),m.font="30px Arial",m.fillStyle="white",m.textAlign="center","NO_CONNECTION"===e?(m.fillText("NO CONNECTION",w,P),m.fillText("There isn't a connection",w,_),m.fillText("with the internet",w,L),m.fillText("please check",w,R),m.fillText("your internet connection",w,W)):"WRONG_SESSION_NUMBER"===e?(m.fillText("WRONG PASSWORD",w,P),m.fillText("this password is not",w,_),m.fillText("recognized in our database",w,L),m.fillText("please check your account",w,R),m.fillText("at Zeeguu",w,W)):(m.fillText("TOO FEW WORDS",w,P),m.fillText("more words needed",w,_),m.fillText("please make sure you have",w,L),m.fillText("at least 5 words",w,R)),m.font="15px Arial",m.fillStyle="white",m.textAlign="center",m.fillText("please press the screen to try again",w,F),c(1),document.getElementById("loginPopup").addEventListener("click",function(){var e=document.getElementById("loginPopup");e.style.visibility="hidden"})}function i(){f=document.getElementById("log_headerSpace"),m=f.getContext("2d"),m.clearRect(0,0,I,x),m.font="15px Arial",m.fillStyle="white",m.textAlign="center",m.fillText("Please fill in your 8 digit code",w,T)}function l(e){f=document.getElementById("pageIconSpace"),m=f.getContext("2d"),m.clearRect(0,0,I,b),1===e?(m.beginPath(),m.arc(170,7,7,0,2*Math.PI),m.fillStyle="#FFFFFF",m.fill(),m.beginPath(),m.arc(190,7,7,0,2*Math.PI),m.fillStyle="#C3C3C3",m.fill()):(m.beginPath(),m.arc(170,7,7,0,2*Math.PI),m.fillStyle="#C3C3C3",m.fill(),m.beginPath(),m.arc(190,7,7,0,2*Math.PI),m.fillStyle="#FFFFFF",m.fill())}function a(e){i(),l(e),n(1,0),n(2,0),n(3,0),n(4,0)}function c(e){v=0,y=0,S=0,p=0,1===e&&(E=0),a(e)}function s(e){v=o(1,e,v)}function d(e){y=o(2,e,y)}function u(e){S=o(3,e,S)}function g(e){p=o(4,e,p)}var f,m,v=0,y=0,S=0,p=0,E=0,I=360,h=360,w=180,x=70,T=62,b=15,B=76,O=105,N=40,C=65,k=80,P=120,_=155,L=185,R=215,W=245,F=280;return function(n){null!==localStorage.getItem("accountCode")?(e.load(),t(),n(e.getCode())):(f=document.getElementById("digitSpace"),m=f.getContext("2d"),a(1),document.getElementById("first_plus").addEventListener("click",function(){s(!0)}),document.getElementById("first_min").addEventListener("click",function(){s(!1)}),document.getElementById("second_plus").addEventListener("click",function(){d(!0)}),document.getElementById("second_min").addEventListener("click",function(){d(!1)}),document.getElementById("third_plus").addEventListener("click",function(){u(!0)}),document.getElementById("third_min").addEventListener("click",function(){u(!1)}),document.getElementById("fourth_plus").addEventListener("click",function(){g(!0)}),document.getElementById("fourth_min").addEventListener("click",function(){g(!1)}),document.getElementById("setNextButton").addEventListener("click",function(){if(0===E)E=v.toString()+y.toString()+S.toString()+p.toString(),c(2);else{E=E+v.toString()+y.toString()+S.toString()+p.toString();var o=n(E);"SUCCESS"===o?(e.saveCode(E),t()):r(o)}}))}}),define("session",["userData","login"],function(e,t){function n(t){var n;console.log("Trying to get words with session: "+t);try{var g=new XMLHttpRequest;g.open("GET",d+u+i+"?session="+t,!1),g.onload=function(){try{var t=JSON.parse(this.responseText),i=0;if(Object.keys(t).length<10)r="TOO_FEW_WORDS";else{for(n=0;n<Object.keys(t).length;n++)o.font=c,o.measureText(String(t[n].from)).width<=l&&o.measureText(String(t[n].to)).width<=l&&(o.font=s,o.measureText(String(t[n].from)).width<=a&&o.measureText(String(t[n].to)).width<=a&&(e.setWordPair(i,t[n].from,t[n].to,t[n].id),i++));e.initNumberOfWords(),e.saveWordPair(),r="SUCCESS"}}catch(d){console.log("wrong session number: "+d),r="WRONG_SESSION_NUMBER"}},g.send()}catch(f){console.log("no internet connection: "+f),r="NO_CONNECTION"}}var o,r,i=50,l=340,a=280,c="45px Arial",s="35px Arial",d="https://zeeguu.unibe.ch/",u="bookmarks_to_study/";return{create:function(t,i){o=t,e.areThereWords()?(r="SUCCESS",e.initNumberOfWords(),console.log("Using words which were already saved.")):n(i)},printWords:function(){e.printWords()},getStatus:function(){return r}}}),define("battery",[],function(){function e(e,t,n,o){var r=(o-90)*Math.PI/180;return{x:e+n*Math.cos(r),y:t+n*Math.sin(r)}}function t(t,n,o,r,i){var l=e(t,n,o,i),a=e(t,n,o,r),c=180>=i-r?"0":"1",s=["M",l.x,l.y,"A",o,o,0,c,0,a.x,a.y].join(" ");return s}var n="green",o="red";return{draw:function(){var e=navigator.battery||navigator.webkitBattery||navigator.mozBattery;e.onchargingchange=function(){e.charging?console.log("battery is charging"):console.log("battery is not charging")},e.onlevelchange=function(){console.log(Math.floor(100*e.level)),document.getElementById("battery").setAttribute("d",t(180,180,180,270,270+180*e.level)),e.level>.15?document.getElementById("battery").setAttribute("stroke",n):document.getElementById("battery").setAttribute("stroke",o)}}}}),define("weather",[],function(){function e(e,t){console.log(e),console.log(t);var n=new XMLHttpRequest;n.open("GET","http://api.openweathermap.org/data/2.5/weather?lat="+e+"&lon="+t+"&APPID="+r,!1),n.onload=function(){console.log("getting weather data.."),console.log(this.responseText),o=JSON.parse(this.responseText),console.log("sunset: "+o.sys.sunset),console.log(JSON.stringify(o))},n.send()}function t(){var t=new XMLHttpRequest;t.open("GET","http://ip-api.com/json",!1),t.onload=function(){console.log("getting location.."),console.log(this.responseText);var t=JSON.parse(this.responseText);e(t.lat,t.lon),console.log(JSON.stringify(t))},t.send()}function n(e){var t=new Date(1e3*e);return 60*t.getUTCHours()+t.getUTCMinutes()-t.getTimezoneOffset()}var o,r="ab2771b4d49ab0798786dd6f2bee71a0",i=!1;return{refresh:function(){i=!0,t()},getSunset:function(){return n(o.sys.sunset)},getSunrise:function(){return n(o.sys.sunrise)},getImageSource:function(){return"http://openweathermap.org/img/w/"+o.weather[0].icon+".png"},getTemperature:function(){return(o.main.temp-273.15).toFixed(0)},setIsRefreshed:function(e){i=e},getIsRefreshed:function(){return i}}}),define("gui",["battery","userData","time","weather"],function(e,t,n,o){function r(e){T=o.getSunrise(),b=o.getSunset(),e>=T&&b>=e?(B=(180/(b-T)).toFixed(2),B=90+(e-T)*B,O="rotate("+B+"deg)",document.getElementById("timeBackground").style.transform=O):(B=(180/(T+(Q-b))).toFixed(2),B=e>b?270+(e-b)*B:270+(e+(Q-b))*B,O="rotate("+B+"deg)",document.getElementById("timeBackground").style.transform=O)}function i(){w.clearRect(0,0,H,X),w.font="30px Arial",w.fillStyle=L,w.textAlign=_,w.fillText(n.getDay(),G,j)}function l(e,t,n,o){h.font=o+N,h.fillStyle=L,h.textAlign=_,h.fillText(e,t,n)}function a(){x.clearRect(0,0,W,M),x.font=C+N,x.fillStyle=L,x.textAlign=_,x.fillText(n.getHours()+":"+n.getMinutes(),W/2,J)}function c(e,t){var n=.1;e.style.display="block";var o=setInterval(function(){n>=.8&&clearInterval(o),e.style.opacity=n,e.style.filter="alpha(opacity="+100*n+")",n+=.1*n},t)}function s(e,t){var n=.8,o=setInterval(function(){.1>=n&&(clearInterval(o),e.style.visibility="hidden"),e.style.opacity=n,e.style.filter="alpha(opacity="+100*n+")",n-=.1*n},t)}function d(e){var t=document.getElementById("imageFade");t.style.visibility="visible",t.style.opacity=1;var n=t.getContext("2d"),o=new Image;o.onload=function(){n.drawImage(o,0,0,W,A)},o.src=e,setTimeout(function(){s(t,Y)},Z)}function u(){document.getElementById("wordSpace").style.backgroundImage="url('assets/background.png')",h.clearRect(0,0,W,D),l(t.getWord(),W/2,U,k);var e=document.getElementById("revealedPage");e.style.visibility="hidden"}function g(){h.clearRect(0,0,W,D),l(t.getWord(),W/2,U,k),l(t.getTranslation(),W/2,z,P),document.getElementById("wordSpace").style.backgroundImage="url('assets/revealed_clicked_background.png')";var e=document.getElementById("revealedPage");e.style.visibility="visible"}function f(){var e=document.getElementById("settingsPage");e.style.visibility="visible",c(e,5)}function m(){var e=document.getElementById("menuPage");e.style.visibility="visible",c(e,5)}function v(e){null===$?$=setTimeout(function(){$=null,e()},300):(clearTimeout($),$=null,f())}function y(){o.setIsRefreshed(!1);var e=document.getElementById("weatherSpace"),t=e.getContext("2d"),n=new Image;n.onload=function(){t.drawImage(n,0,0)},n.src=o.getImageSource()}function S(){var e=document.getElementById("temperatureSpace"),t=e.getContext("2d");t.clearRect(0,0,q,q),t.font=R,t.fillStyle=L,t.textAlign=_,t.fillText(o.getTemperature()+"°C",K,K)}function p(){t.addEvent("right"),t.saveCurrentState(),t.saveEvents(),t.sendEvents();var e="assets/right_icon.png";t.improvedFlashCardMethod(!0),d(e),u()}function E(){t.addEvent("wrong"),t.saveCurrentState(),t.saveEvents(),t.sendEvents();var e="assets/wrong_icon.png";t.improvedFlashCardMethod(!1),d(e),u()}function I(e){if(t.removeWord())d(e),t.saveCurrentState(),t.saveEvents(),t.saveWordPair(),t.sendEvents(),u();else{console.log("show popup");var n=document.getElementById("imageFade");n.style.visibility="visible",n.style.opacity=.8;var o=n.getContext("2d");o.clearRect(0,0,W,F/2),o.font="20px Arial",o.fillStyle="white",o.textAlign="center",o.fillText("TOO FEW WORDS",W/2,POPUP_TEXT_LINE1),o.fillText("there are too",W/2,POPUP_TEXT_LINE2),o.fillText("few words left to",W/2,POPUP_TEXT_LINE3),o.fillText("use this option",W/2,POPUP_TEXT_LINE4),setTimeout(function(){s(n,Y)},WAITING_TIME_FOR_POPUP_TO_DISAPPEAR)}}var h,w,x,T,b,B,O,N="px Arial",C=120,k=45,P=35,_="center",L="white",R="17px Arial",W=360,F=360,A=120,M=180,J=160,D=120,U=45,z=95,H=100,X=90,G=72,j=63,q=50,K=25,Y=20,Z=100,Q=1440,V="360px 180px",$=null,ee=0,te=["url('assets/countryside_background.png')","url('assets/city_background.png')","url('assets/simple_background.png')"];return{draw:function(){n.create();var t=60*n.getHours()+1*n.getMinutes();a(),i(),r(t),e.draw(),o.getIsRefreshed()&&y(),S()},create:function(e){h=e;var n=document.getElementById("digitalTime");x=n.getContext("2d");var r=document.getElementById("iconSpace");w=r.getContext("2d"),o.refresh(!0),t.initializeIntervals(),u(),document.getElementById("wordSpace").addEventListener("click",function(){t.addEvent("reveal"),v(g),t.saveEvents()}),document.getElementById("revealButton").addEventListener("click",function(){t.addEvent("reveal"),g(),t.saveEvents()}),document.getElementById("wrongSpace").addEventListener("click",function(){E()}),document.getElementById("wrongButton").addEventListener("click",function(){E()}),document.getElementById("menuSpace").addEventListener("click",function(){v(m)}),document.getElementById("menuButton").addEventListener("click",function(){m()}),document.getElementById("rightSpace").addEventListener("click",function(){p()}),document.getElementById("rightButton").addEventListener("click",function(){p()}),document.getElementById("menuLargeSpace").addEventListener("click",function(){var e=document.getElementById("menuPage");s(e,5)}),document.getElementById("wrongTranslationButton").addEventListener("click",function(){t.addEvent("wrongTranslation"),I("assets/trash_icon.png")}),document.getElementById("learnedButton").addEventListener("click",function(){t.addEvent("learnedIt"),I("assets/right_icon.png")}),document.getElementById("backButtonInMenu").addEventListener("click",function(){var e=document.getElementById("menuPage");s(e,5)}),document.getElementById("settingsSpace").addEventListener("click",function(){var e=document.getElementById("settingsPage");s(e,5)}),document.getElementById("reverseButton").addEventListener("click",function(){t.addEvent("reverse"),t.setReverseStatus(!t.getReverseStatus()),u()}),document.getElementById("time").addEventListener("click",function(){var e=document.getElementById("landscapeBackground");e.style.background=te[ee],e.style.backgroundSize=V,ee===te.length-1?ee=0:ee++}),document.getElementById("logOutButton").addEventListener("click",function(){t.clear(),document.location.reload(!0)}),document.getElementById("backButtonInSettings").addEventListener("click",function(){var e=document.getElementById("settingsPage");s(e,5)})}}}),define("device",["userData","weather"],function(e,t){function n(){try{tizen.power.setScreenStateChangeListener(function(n,o){"SCREEN_NORMAL"===o&&"SCREEN_OFF"===n?(console.log("We just woke up"),e.addEvent("screenOn"),t.refresh(!0)):(console.log("The display has been switched off"),e.addEvent("screenOff")),e.saveEvents()})}catch(n){}}function o(){document.addEventListener("tizenhwkey",function(e){if("back"===e.keyName)try{tizen.application.getCurrentApplication().exit()}catch(t){}})}return{create:function(){o()},listen:function(){n()}}}),require(["login","session","gui","device"],function(e,t,n,o){function r(){n.draw(),o.listen(),setTimeout(r,1e3)}function i(e){t.create(a,e),t.printWords();var i=t.getStatus();return"SUCCESS"!==i?i:(n.create(a),o.create(),r(),i)}var l=document.getElementById("wordSpace"),a=l.getContext("2d");new e(i)}),define("main",function(){});