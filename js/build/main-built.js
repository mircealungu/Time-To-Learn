// Copyright (c) 2009 Kazuhiko Arase

// Licensed under the MIT license:

//   http://www.opensource.org/licenses/mit-license.php

define("time",[],function(){function e(){var e;try{e=tizen.time.getCurrentDateTime()}catch(e){console.error("Error: ",e.message)}return e}function t(e){return e<10&&(e="0"+e),e}function n(){r=e(),a=r.getFullYear(),s=t(r.getDate()),l=t(r.getMonth()+1),c=t(r.getHours()),u=t(r.getMinutes()),d=t(r.getSeconds())}var o,i,r,a,s,l,c,u,d,g=0,h=0,f=!1,m=100,p=90,v="white",y=72,w=63,E=180,I=360,C=160,T="120px Arial",k="white";return{create:function(){o=document.getElementById("timeCanvas").getContext("2d"),i=document.getElementById("iconCanvas").getContext("2d")},refresh:function(){n(),f||(g++,h++)},getTotalTime:function(){return g},setTotalTime:function(e){g=e},getSessionTime:function(){return h},resetSessionTime:function(){h=0},pauseUsageTracking:function(){f=!0},startUsageTracking:function(){f=!1},getTimestamp:function(){return n(),a+"-"+l+"-"+s+"T"+c+":"+u+":"+d},getHours:function(){return c},getMinutes:function(){return u},drawDate:function(){i.clearRect(0,0,m,p),i.font="30px Arial",i.fillStyle=v,i.textAlign="center",i.fillText(s,y,w)},draw:function(){o.clearRect(0,0,I,E),o.font=T,o.fillStyle=k,o.textAlign="center",o.fillText(c+":"+u,I/2,C)}}}),define("events",["time"],function(e){var t,n,o="https://zeeguu.unibe.ch/api/upload_smartwatch_events";return{save:function(o,i){e.create(),t={bookmark_id:i,time:e.getTimestamp(),event:o},null!==localStorage.getItem("events")?(n=JSON.parse(localStorage.getItem("events")),n.push(t),localStorage.setItem("events",JSON.stringify(n))):(n=[],n.push(t),localStorage.setItem("events",JSON.stringify(n)))},send:function(e){var t=new FormData;t.append("events",localStorage.getItem("events"));var n=new XMLHttpRequest;n.open("POST",o+"?session="+e,!0),n.onload=function(){"OK"===this.responseText&&localStorage.removeItem("events")},n.send(t)}}}),define("clickTracker",["time"],function(e){function t(){a=document.getElementById("clickTracker"),a.style.visibility="visible",r=document.getElementById("clickTrackerCanvas").getContext("2d"),r.clearRect(0,0,l,c),s="hidden"===document.getElementById("revealedPage").style.visibility,document.getElementById("clickTrackerCanvas").addEventListener("click",function(){a.style.visibility="hidden"})}function n(e,t,n,o){o&&(r.beginPath(),r.arc(t,n,u,d,g),r.fillStyle=e,r.fill(),r.stroke())}var o,i,r,a,s=!1,l=360,c=360,u=6,d=0,g=2*Math.PI,h="https://zeeguu.unibe.ch/api/upload_user_activity_data";return{showPositions:function(){t();for(var e=0;e<i.length;e++)switch(i[e].type){case"reveal":n("yellow",i[e].posX,i[e].posY,s);break;case"time":n("white",i[e].posX,i[e].posY,!0);break;case"settings":n("blue",i[e].posX,i[e].posY,!0);break;case"wrong":n("red",i[e].posX,i[e].posY,!s);break;case"menu":n("orange",i[e].posX,i[e].posY,!s);break;case"right":n("green",i[e].posX,i[e].posY,!s)}},saveClick:function(e,t,n){o={posX:e,posY:t,type:n},null!==localStorage.getItem("clicks")?(i=JSON.parse(localStorage.getItem("clicks")),i.push(o),localStorage.setItem("clicks",JSON.stringify(i))):(i=[],i.push(o),localStorage.setItem("clicks",JSON.stringify(i)))},sendClicks:function(t){var n=new FormData;n.append("time",e.getTimestamp()),n.append("event","clicks"),n.append("value","see extra data"),n.append("extra_data",JSON.stringify(localStorage.getItem("clicks")));var o=new XMLHttpRequest;o.open("POST",h+"?session="+t,!0),o.onload=function(){"OK"===this.responseText&&localStorage.removeItem("clicks")},o.send(n)}}}),define("userData",["events","clickTracker"],function(e,t){function n(){return JSON.parse(localStorage.getItem("reverse"))}var o=0,i=null,r=null,a=[],s=!1,l=5;return{getAllWords:function(){return a},addWords:function(e,t){a=a.concat(t),a=a.slice(0,e)},getWordPair:function(e){return a[e]},areThereWords:function(){return a.length>0},updateWordPair:function(e){e?(a[0].timesCorrect++,a.splice(a[0].timesCorrect*l,0,a[0])):(a[0].timesCorrect=0,a.splice(l,0,a[0])),a.splice(0,1)},getWord:function(){return n()?a[0].translation:a[0].word},removeWord:function(){return a.length>l&&(a.splice(0,1),!0)},getTranslation:function(){return n()?a[0].word:a[0].translation},load:function(){0!==localStorage.length&&(o=localStorage.getItem("accountCode"),null!==localStorage.getItem("wordPair")&&(a=JSON.parse(localStorage.getItem("wordPair"))))},saveCode:function(e){o=e,localStorage.setItem("accountCode",o)},savePassword:function(e){r=e,localStorage.setItem("password",r)},saveUuid:function(e){i=e,localStorage.setItem("uuid",i)},saveWordPair:function(){localStorage.setItem("wordPair",JSON.stringify(a))},saveEvent:function(t){e.save(t,a[0].id)},sendEvents:function(){try{e.send(o)}catch(e){console.log("Error during sending events: "+e)}},saveClick:function(e,n,o){t.saveClick(e,n,o)},sendClicks:function(){try{t.sendClicks(o)}catch(e){console.log("Error during sending clicks: "+e)}},getCode:function(){return o},getPassword:function(){return r},getUuid:function(){return i},getReverseStatus:function(){return JSON.parse(localStorage.getItem("reverse"))},setReverseStatus:function(e){localStorage.setItem("reverse",JSON.stringify(e))},getSessionPopupShown:function(){return s},setSessionPopupShown:function(e){s=e},increaseLandscapeNumber:function(){localStorage.setItem("landscapeNumber",parseInt(localStorage.getItem("landscapeNumber"))+1)},getLandscapeNumber:function(){return parseInt(localStorage.getItem("landscapeNumber"))},setLandscapeNumber:function(e){localStorage.setItem("landscapeNumber",e)},numberOfFlashcards:function(){return l},clear:function(){localStorage.clear()}}}),define("fireworks",[],function(){function e(e,t){return Math.random()*(t-e)+e}function t(e,t,n,o){var i=e-n,r=t-o;return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))}function n(){s=[],l=[],c=document.getElementById("popupFireworksCanvas"),u=c.getContext("2d"),d=window.innerWidth,g=window.innerHeight,c.width=d,c.height=g,window.addEventListener("resize",function(){c.width=d=window.innerWidth,c.height=g=window.innerHeight})}function o(n,o,i,r){for(this.x=this.sx=n,this.y=this.sy=o,this.tx=i,this.ty=r,this.distanceToTarget=t(n,o,i,r),this.distanceTraveled=0,this.coordinates=[],this.coordinateCount=3;this.coordinateCount--;)this.coordinates.push([this.x,this.y]);this.angle=Math.atan2(r-o,i-n),this.speed=f.rocketSpeed,this.acceleration=f.rocketAcceleration,this.brightness=e(50,80),this.hue=p,this.targetRadius=1,this.targetDirection=!1,w++}function i(t,n){for(this.x=t,this.y=n,this.coordinates=[],this.coordinateCount=5;this.coordinateCount--;)this.coordinates.push([this.x,this.y]);this.angle=e(0,2*Math.PI),this.speed=e(1,10),this.friction=f.particleFriction,this.gravity=f.particleGravity,this.hue=e(p-20,p+20),this.brightness=e(50,80),this.alpha=1,this.decay=e(.01,.03)}function r(t,n){for(var o=Math.round(e(f.particleMinCount,f.particleMaxCount));o--;)l.push(new i(t,n))}function a(){h=window.requestAnimFrame(a),p+=.5,u.globalCompositeOperation="destination-out",u.fillStyle="rgba(0, 0, 0, 0.5)",u.fillRect(0,0,d,g),u.globalCompositeOperation="lighter";for(var t=s.length;t--;)s[t].draw(),s[t].update(t);for(t=l.length;t--;)l[t].draw(),l[t].update(t);y>=f.timerInterval?m.down||(s.push(new o(d/2,g,e(0,d),e(0,g/2))),y=0):y++,v>=f.clickLimiter?m.down&&(s.push(new o(d/2,g,m.x,m.y)),v=0):v++}var s,l,c,u,d,g,h,f={startingHue:120,clickLimiter:5,timerInterval:40,showTargets:!1,rocketSpeed:2,rocketAcceleration:1.03,particleFriction:.95,particleGravity:1,particleMinCount:5,particleMaxCount:15,particleMinRadius:3,particleMaxRadius:5},m={down:!1,x:0,y:0},p=f.startingHue,v=0,y=0,w=0;return window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),o.prototype.update=function(e){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.targetDirection?this.targetRadius>1?this.targetRadius-=.15:this.targetDirection=!1:this.targetRadius<8?this.targetRadius+=.15:this.targetDirection=!0,this.speed*=this.acceleration;var n=Math.cos(this.angle)*this.speed,o=Math.sin(this.angle)*this.speed;this.distanceTraveled=t(this.sx,this.sy,this.x+n,this.y+o),this.distanceTraveled>=this.distanceToTarget?(r(this.tx,this.ty),s.splice(e,1)):(this.x+=n,this.y+=o)},o.prototype.draw=function(){var e=this.coordinates[this.coordinates.length-1];u.beginPath(),u.moveTo(e[0],e[1]),u.lineTo(this.x,this.y),u.strokeStyle="hsl("+this.hue+",100%,"+this.brightness+"%)",u.stroke(),f.showTargets&&(u.beginPath(),u.arc(this.tx,this.ty,this.targetRadius,0,2*Math.PI),u.stroke())},i.prototype.update=function(e){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.speed*=this.friction,this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed+this.gravity,this.alpha-=this.decay,this.alpha<=this.decay&&l.splice(e,1)},i.prototype.draw=function(){var t=(this.coordinates[this.coordinates.length-1],Math.round(e(f.particleMinRadius,f.particleMaxRadius))),n=u.createRadialGradient(this.x,this.y,0,this.x,this.y,t);n.addColorStop(0,"white"),n.addColorStop(.1,"white"),n.addColorStop(.1,"hsla("+this.hue+",100%,"+this.brightness+"%,"+this.alpha+")"),n.addColorStop(1,"black"),u.beginPath(),u.fillStyle=n,u.arc(this.x,this.y,t,2*Math.PI,!1),u.fill()},{start:function(){n(),h||a()},stop:function(){h&&(window.cancelAnimationFrame(h),u.clearRect(0,0,c.width,c.height),h=void 0)}}}),define("effects",[],function(){var e,t,n=360,o=120,i=20;return{feedbackByImage:function(r){e=document.getElementById("popupWordCanvas"),e.style.visibility="visible",e.style.opacity=1,t=e.getContext("2d");var a=new Image;a.onload=function(){t.drawImage(a,0,0,n,o)},a.src=r,this.fade(e,i)},fade:function(e,t){var n=.9,o=setInterval(function(){n<=.1&&(clearInterval(o),e.style.visibility="hidden"),e.style.opacity=n,e.style.filter="alpha(opacity="+100*n+")",n-=.1*n},t)},unfade:function(e,t){var n=.1;e.style.display="block";var o=setInterval(function(){n>=.9&&clearInterval(o),e.style.opacity=n,e.style.filter="alpha(opacity="+100*n+")",n+=.1*n},t)}}}),define("popup",["fireworks","effects"],function(e,t){function n(){s.fillStyle=k,s.textAlign="center"}function o(){r.style.visibility="visible",r.style.opacity="1.0",s.clearRect(0,0,l,c),e.start(),s.font=C,s.fillText("Great job!",l/2,w),s.font=T}function i(e){var t=new Image;t.onload=function(){s.drawImage(t,80,10,200,200)},t.src="assets/medal_"+e+".png"}var r,a,s,l=360,c=360,u=110,d=155,g=185,h=215,f=245,m=290,p="30px Arial",v="white",y="15px Arial",w=245,E=272,I=293,C="40px Arial",T="20px Arial",k="white",S=5;return{medalInitialization:function(){r=document.getElementById("popup"),s=document.getElementById("popupCanvas").getContext("2d"),n(),document.getElementById("okayButtonInPopup").addEventListener("click",function(){e.stop(),t.fade(r,S)})},forLogin:function(e,t){document.getElementById("loginPopup").style.visibility="visible",a=document.getElementById("loginPopupCanvas").getContext("2d"),a.clearRect(0,0,l,c),a.font=p,a.fillStyle=v,a.textAlign="center","NO_CONNECTION"===e?(a.fillText("NO CONNECTION",l/2,u),a.fillText("There isn't a connection",l/2,d),a.fillText("with the internet.",l/2,g),a.fillText("Please check your",l/2,h),a.fillText("internet connection.",l/2,f)):"WRONG_SESSION_NUMBER"===e?(a.fillText("WRONG PASSWORD",l/2,u),a.fillText("This password is not",l/2,d),a.fillText("recognized in our database.",l/2,g),a.fillText("Please check your account",l/2,h),a.fillText("at Zeeguu.",l/2,f)):(a.fillText("TOO FEW WORDS",l/2,u),a.fillText("More words needed,",l/2,d),a.fillText("please make sure you have",l/2,g),a.fillText("at least 5 words.",l/2,h)),a.font=y,a.fillStyle=v,a.textAlign="center",a.fillText("please press the screen to try again",l/2,m),t(1),document.getElementById("loginPopupCanvas").addEventListener("click",function(){document.getElementById("loginPopup").style.visibility="hidden"})},forWordsLearned:function(e){o(),i("words_learned"),1===e?(s.fillText("You just learned",l/2,E),s.fillText("your first word!",l/2,I)):(s.fillText("You have already learned",l/2,E),s.fillText(e+" words",l/2,I))},forTotalTime:function(e){o(),i("total_time"),s.fillText("You have already used the app",l/2,E),s.fillText("for "+e,l/2,I)},forSessionTime:function(){o(),i("longest_session"),s.fillText("You are currently in",l/2,E),s.fillText("your longest session",l/2,I)},forLearningStreak:function(e){o(),i("longest_streak"),s.fillText("You have learned for",l/2,E),s.fillText(e+" days in a row",l/2,I)}}}),define("login",["userData","popup"],function(e,t){function n(){document.getElementById("languageFlags").style.display="none",document.getElementById("mainPage").style.display="block"}function o(t){i(),console.log(v.toString()),a();for(var r=document.getElementsByClassName("flagButton"),s=function(){var i=this.getAttribute("id").substring(0,2);d(i),0!==e.getCode()?(n(),t(e.getCode())):o()},l=0;l<r.length;l++)r[l].addEventListener("click",s,!1)}function i(){for(var e=1,t=1,n=1;n<v.length+1;n++){if(n>4&&(n-1)%4==0){e++;var o=document.createElement("div");o.id=e+"BlockOfFlags",o.style.display="none",document.getElementById("languageFlags").appendChild(o)}var i=document.createElement("div");i.className="flagButton",i.id=v[n-1]+"Flag",r(i,t),t++,t>4&&(t=1),document.getElementById(e+"BlockOfFlags").appendChild(i)}}function r(e,t){switch(t){case 1:e.style.top="70px",e.style.left="60px";break;case 2:e.style.top="70px",e.style.left="188px";break;case 3:e.style.top="189px",e.style.left="60px";break;case 4:e.style.top="189px",e.style.left="188px";break;default:console.log("WEIRD INDEX FOUND")}}function a(){var e=document.getElementById("languageFlags"),t=e.childElementCount-2,n=1;s(n,t),document.getElementById("nextLangButton").addEventListener("click",function(){document.getElementById(n+"BlockOfFlags").style.display="none",n++,document.getElementById(n+"BlockOfFlags").style.display="block",s(n,t)}),document.getElementById("backLangButton").addEventListener("click",function(){document.getElementById(n+"BlockOfFlags").style.display="none",n--,document.getElementById(n+"BlockOfFlags").style.display="block",s(n,t)})}function s(e,t){t>1&&e<t?document.getElementById("nextLangButton").style.display="block":document.getElementById("nextLangButton").style.display="none",t>1&&e>1?document.getElementById("backLangButton").style.display="block":document.getElementById("backLangButton").style.display="none"}function l(e,t){const n="https://zeeguu.unibe.ch/api/learned_language/";try{var o=new XMLHttpRequest;o.open("POST",n+t+"?session="+e,!0),o.onload=function(){try{console.log(this.responseText)}catch(e){console.log("INVALID_REQUEST")}},o.send()}catch(e){console.log("NO_CONNECTION")}}function c(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function u(){return Math.floor(1+1e6*Math.random()).toString()}function d(t){var n=c(),o=u(),i=new FormData;i.append("uuid",n),i.append("password",o),i.append("learned_language_code",t),i.append("native_language_code","en");try{var r=new XMLHttpRequest;r.open("POST",f,!1),r.onload=function(){try{e.saveCode(JSON.parse(this.responseText)),e.saveUuid(n),e.savePassword(o),l(JSON.parse(this.responseText),t)}catch(e){console.log(m)}},r.send(i)}catch(e){console.log(p)}console.log("new account: uuid == "+e.getUuid("uuid")),console.log("new account: password == "+e.getPassword("password")),console.log("new account: accountcode == "+e.getCode("accountCode"))}function g(t,n){var o=new FormData;o.append("password",n);try{var i=new XMLHttpRequest;i.open("POST",h+t,!1),i.onload=function(){try{e.saveCode(JSON.parse(this.responseText))}catch(e){console.log(m)}},i.send(o)}catch(e){console.log(p)}}const h="https://zeeguu.unibe.ch/api/get_anon_session/",f="https://zeeguu.unibe.ch/api/add_anon_user",m="WRONG_SESSION_NUMBER",p="NO_CONNECTION";var v=["fr","de","es","nl","es","nl"];return function(t){localStorage.clear(),null!==e.getUuid()&&null!==e.getPassword()?(g(e.getUuid(),e.getPassword()),0!==e.getCode()?(n(),t(e.getCode())):o(t)):o(t)}}),define("session",["userData","login"],function(e,t){function n(e){return Object.keys(e).length}function o(e,t){return s.measureText(String(e)).width<=t}function i(e,t){return s.font=h,!!(o(e,d)&&o(t,d)&&(s.font=f,o(e,g)&&o(t,g)))}function r(e,t,n,o,i){c[e]={word:t,translation:n,id:o,context:i,timesCorrect:0}}function a(e,t){if(0===t.length)return e;for(var n=0;n<t.length;n++)for(var o=0;o<e.length;o++)if(t[n].id===e[o].id){e.splice(o,1);break}return e}var s,l,c=[],u=50,d=340,g=280,h="45px Arial",f="35px Arial",m="https://zeeguu.unibe.ch/api/",p="bookmarks_to_study/";return{create:function(t,n){s=t,e.areThereWords()?l="SUCCESS":(this.getWords(n,!1),this.updateWords())},getWords:function(t,o){if(e.getAllWords().length<u)try{var s=new XMLHttpRequest;s.open("GET",m+p+u+"?session="+t,o),s.onload=function(){try{var t=JSON.parse(this.responseText),o=0;if(n(t)<e.numberOfFlashcards())l="TOO_FEW_WORDS";else{for(var s=0;s<n(t);s++)i(t[s].from,t[s].to)&&(r(o,t[s].from,t[s].to,t[s].id,t[s].context),o++);c=a(c,e.getAllWords()),l="SUCCESS"}}catch(e){l="WRONG_SESSION_NUMBER"}},s.send()}catch(e){l="NO_CONNECTION"}},updateWords:function(){e.getAllWords().length<u&&(e.addWords(u,c),c=[],e.saveWordPair())},getStatus:function(){return l}}}),define("battery",[],function(){function e(e,t,n,o){var i=(o-90)*Math.PI/180;return{x:e+n*Math.cos(i),y:t+n*Math.sin(i)}}function t(t,n,o,i,r){var a=e(t,n,o,r),s=e(t,n,o,i),l=r-i<=180?"0":"1",c=["M",a.x,a.y,"A",o,o,0,l,0,s.x,s.y].join(" ");return c}var n="green",o="red",i=.15;return{draw:function(){var e=navigator.battery||navigator.webkitBattery||navigator.mozBattery;e.onlevelchange=function(){document.getElementById("battery").setAttribute("d",t(180,180,180,270,270+180*e.level)),e.level>i?document.getElementById("battery").setAttribute("stroke",n):document.getElementById("battery").setAttribute("stroke",o)}}}}),define("weather",[],function(){function e(e,t){try{var n=new XMLHttpRequest;n.open("GET","http://api.openweathermap.org/data/2.5/weather?lat="+e+"&lon="+t+"&APPID="+a,!1),n.onload=function(){s=JSON.parse(this.responseText),localStorage.setItem("weather",JSON.stringify(s))},n.send()}catch(e){l=!1}}function t(){var t=new XMLHttpRequest;try{t.open("GET","http://ip-api.com/json",!1),t.onload=function(){var t=JSON.parse(this.responseText);e(t.lat,t.lon)},t.send()}catch(e){l=!1}}function n(e){var t=new Date(1e3*e);return 60*t.getUTCHours()+t.getUTCMinutes()-t.getTimezoneOffset()}function o(){return(s.main.temp-273.15).toFixed(0)}var i,r,a="ab2771b4d49ab0798786dd6f2bee71a0",s=null,l=!1,c=50,u=50,d=25,g="17px Arial",h="white";return{create:function(){i=document.getElementById("weatherCanvas").getContext("2d"),r=document.getElementById("temperatureCanvas").getContext("2d")},refresh:function(){l=!0,t(),null===s&&(s=JSON.parse(localStorage.getItem("weather")))},getSunset:function(){return n(s.sys.sunset)},getSunrise:function(){return n(s.sys.sunrise)},draw:function(){if(l){l=!1;var e=new Image;i.clearRect(0,0,c,c),e.onload=function(){i.drawImage(e,0,0)},e.src="http://openweathermap.org/img/w/"+s.weather[0].icon+".png",r.clearRect(0,0,u,u),r.font=g,r.fillStyle=h,r.textAlign="center",r.fillText(o()+"Â°C",d,d)}}}}),define("background",["userData","weather","time"],function(e,t,n){var o,i,r,a,s,l=["url('assets/simple_background.png')","url('assets/city_background.png')","url('assets/countryside_background.png')"],c=1440,u="360px 180px";return{create:function(){o=document.getElementById("landscapeCanvas"),null===localStorage.getItem("landscapeNumber")&&e.setLandscapeNumber(0),o.style.background=l[e.getLandscapeNumber()],o.style.backgroundSize=u},change:function(){e.increaseLandscapeNumber(),e.getLandscapeNumber()===l.length&&e.setLandscapeNumber(0),o.style.background=l[e.getLandscapeNumber()],o.style.backgroundSize=u},rotate:function(){s=t.getSunrise(),a=t.getSunset(),r=60*n.getHours()+1*n.getMinutes(),r>=s&&r<=a?(i=(180/(a-s)).toFixed(2),i=90+(r-s)*i,document.getElementById("rotationCanvas").style.transform="rotate("+i+"deg)"):(i=(180/(s+(c-a))).toFixed(2),i=r>a?270+(r-a)*i:270+(r+(c-a))*i,document.getElementById("rotationCanvas").style.transform="rotate("+i+"deg)")}}}),define("profile",["time","effects","popup","userData"],function(e,t,n,o){function i(){document.getElementById("leftInProfile").addEventListener("click",function(){d()}),document.getElementById("rightInProfile").addEventListener("click",function(){g()}),document.getElementById("backButtonInProfile").addEventListener("click",function(){t.fade(f,S)})}function r(e){return 0===e?e="00":e>0&&e<10&&(e="0"+e),e}function a(e){var t=r(Math.floor(e/3600)),n=r(Math.floor(e%3600/60)),o=r(Math.floor(e%3600%60));return t+":"+n+":"+o}function s(e){for(var t=0;t<E.length;t++)p.beginPath(),p.arc(e+20*t,R,W,0,2*Math.PI),p.fillStyle=F,p.fill()}function l(e){p.beginPath(),p.arc(e,R,W,0,2*Math.PI),p.fillStyle=H,p.fill()}function c(e){p=document.getElementById("profilePageIconCanvas").getContext("2d"),p.clearRect(0,0,80,20),s(D),l(e)}function u(e){m.font=k,m.textAlign="center";var t=new Image;t.onload=function(){switch(m.drawImage(t,x,b,_,L),m.font=k,m.textAlign="center",e){case 0:m.fillText("words learned:",C/2,A),1!==v?m.fillText(v+" words",C/2,P):m.fillText(v+" word",C/2,P),c(D);break;case 1:m.fillText("total time:",C/2,A),m.fillText(a(localStorage.getItem("totalTime")),C/2,P),c(N);break;case 2:m.fillText("longest session:",C/2,A),m.fillText(a(localStorage.getItem("longestSession")),C/2,P),c(M);break;case 3:m.fillText("learning streak:",C/2,A),localStorage.getItem("longestLearningStreak")>1?m.fillText(localStorage.getItem("longestLearningStreak")+" days",C/2,P):m.fillText("none",C/2,P),c(O)}},t.src=E[e]}function d(){I--,I<0&&(I=E.length-1),u(I)}function g(){I++,I>E.length-1&&(I=0),u(I)}function h(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}var f,m,p,v=0,y=1,w=null,E=["assets/medal_words_learned_for_profile.png","assets/medal_total_time_for_profile.png","assets/medal_longest_session_for_profile.png","assets/medal_longest_streak_for_profile.png"],I=0,C=360,T="40px Arial",k="25px Arial",S=5,B=65,x=90,b=80,_=180,L=196,A=220,P=260,D=10,N=30,M=50,O=70,R=9,W=7,F="#C3C3C3",H="#FFFFFF";return{create:function(){null===localStorage.getItem("totalTime")?localStorage.setItem("totalTime",0):e.setTotalTime(localStorage.getItem("totalTime")),null===localStorage.getItem("longestSession")&&localStorage.setItem("longestSession",0),null!==localStorage.getItem("wordsLearned")&&(v=localStorage.getItem("wordsLearned")),null!==localStorage.getItem("currentLearningStreak")&&(y=localStorage.getItem("currentLearningStreak")),null!==localStorage.getItem("dateLastActive")&&(w=new Date(Date.parse(localStorage.getItem("dateLastActive")))),null===localStorage.getItem("longestLearningStreak")&&localStorage.setItem("longestLearningStreak",1),i(),n.medalInitialization()},refresh:function(){localStorage.setItem("totalTime",e.getTotalTime()),0===e.getTotalTime()||900!==e.getTotalTime()&&1800!==e.getTotalTime()&&e.getTotalTime()%3600!==0||n.forTotalTime(a(e.getTotalTime())),e.getSessionTime()>localStorage.getItem("longestSession")&&(localStorage.setItem("longestSession",e.getSessionTime()),o.getSessionPopupShown()||(n.forSessionTime(),o.setSessionPopupShown(!0)))},save:function(){localStorage.setItem("wordsLearned",v),localStorage.setItem("currentLearningStreak",y),localStorage.setItem("dateLastActive",w),y>localStorage.getItem("longestLearningStreak")&&(localStorage.setItem("longestLearningStreak",y),n.forLearningStreak(y))},getWordsLearned:function(){return v},increaseWordsLearned:function(){v++,0===v||1!==v&&v%10!==0||n.forWordsLearned(v)},userIsActive:function(){if(null===w)w=new Date;else{var e=new Date;h(e,w)||(w.setDate(w.getDate()+1),h(e,w)?y++:y=1),w=e}},show:function(){f=document.getElementById("profilePage"),f.style.visibility="visible",f.style.opacity="1.0",m=document.getElementById("profileCanvas").getContext("2d"),m.clearRect(0,0,C,C);var e=new Image;e.onload=function(){m.drawImage(e,0,0),m.font=T,m.fillStyle="white",m.textAlign="center",m.fillText("profile",C/2,B)},e.src="assets/banner.png",I=0,u(I)}}});var QRCode;!function(){function e(e){this.mode=c.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,n=this.data.length;t<n;t++){var o=[],i=this.data.charCodeAt(t);i>65536?(o[0]=240|(1835008&i)>>>18,o[1]=128|(258048&i)>>>12,o[2]=128|(4032&i)>>>6,o[3]=128|63&i):i>2048?(o[0]=224|(61440&i)>>>12,o[1]=128|(4032&i)>>>6,o[2]=128|63&i):i>128?(o[0]=192|(1984&i)>>>6,o[1]=128|63&i):o[0]=i,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function n(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);for(var n=0;n<e.length&&0==e[n];)n++;this.num=new Array(e.length-n+t);for(var o=0;o<e.length-n;o++)this.num[o]=e[o+n]}function o(e,t){this.totalCount=e,this.dataCount=t}function i(){this.buffer=[],this.length=0}function r(){return"undefined"!=typeof CanvasRenderingContext2D}function a(){var e=!1,t=navigator.userAgent;if(/android/i.test(t)){e=!0;var n=t.toString().match(/android ([0-9]\.[0-9])/i);n&&n[1]&&(e=parseFloat(n[1]))}return e}function s(e,t){for(var n=1,o=l(e),i=0,r=m.length;i<=r;i++){var a=0;switch(t){case u.L:a=m[i][0];break;case u.M:a=m[i][1];break;case u.Q:a=m[i][2];break;case u.H:a=m[i][3]}if(o<=a)break;n++}if(n>m.length)throw new Error("Too long data");return n}function l(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;t<n;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++){this.modules[o]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[o][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++)if(!(e+n<=-1||this.moduleCount<=e+n))for(var o=-1;o<=7;o++)t+o<=-1||this.moduleCount<=t+o||(0<=n&&n<=6&&(0==o||6==o)||0<=o&&o<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=o&&o<=4?this.modules[e+n][t+o]=!0:this.modules[e+n][t+o]=!1)},getBestMaskPattern:function(){for(var e=0,t=0,n=0;n<8;n++){this.makeImpl(!0,n);var o=g.getLostPoint(this);(0==n||e>o)&&(e=o,t=n)}return t},createMovieClip:function(e,t,n){var o=e.createEmptyMovieClip(t,n),i=1;this.make();for(var r=0;r<this.modules.length;r++)for(var a=r*i,s=0;s<this.modules[r].length;s++){var l=s*i,c=this.modules[r][s];c&&(o.beginFill(0,100),o.moveTo(l,a),o.lineTo(l+i,a),o.lineTo(l+i,a+i),o.lineTo(l,a+i),o.endFill())}return o},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=g.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var o=e[t],i=e[n];if(null==this.modules[o][i])for(var r=-2;r<=2;r++)for(var a=-2;a<=2;a++)r==-2||2==r||a==-2||2==a||0==r&&0==a?this.modules[o+r][i+a]=!0:this.modules[o+r][i+a]=!1}},setupTypeNumber:function(e){for(var t=g.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var o=!e&&1==(t>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=o}for(var n=0;n<18;n++){var o=!e&&1==(t>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=o}},setupTypeInfo:function(e,t){for(var n=this.errorCorrectLevel<<3|t,o=g.getBCHTypeInfo(n),i=0;i<15;i++){var r=!e&&1==(o>>i&1);i<6?this.modules[i][8]=r:i<8?this.modules[i+1][8]=r:this.modules[this.moduleCount-15+i][8]=r}for(var i=0;i<15;i++){var r=!e&&1==(o>>i&1);i<8?this.modules[8][this.moduleCount-i-1]=r:i<9?this.modules[8][15-i-1+1]=r:this.modules[8][15-i-1]=r}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var n=-1,o=this.moduleCount-1,i=7,r=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;s<2;s++)if(null==this.modules[o][a-s]){var l=!1;r<e.length&&(l=1==(e[r]>>>i&1));var c=g.getMask(t,o,a-s);c&&(l=!l),this.modules[o][a-s]=l,i--,i==-1&&(r++,i=7)}if(o+=n,o<0||this.moduleCount<=o){o-=n,n=-n;break}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,r){for(var a=o.getRSBlocks(e,n),s=new i,l=0;l<r.length;l++){var c=r[l];s.put(c.mode,4),s.put(c.getLength(),g.getLengthInBits(c.mode,e)),c.write(s)}for(var u=0,l=0;l<a.length;l++)u+=a[l].dataCount;if(s.getLengthInBits()>8*u)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*u+")");for(s.getLengthInBits()+4<=8*u&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;;){if(s.getLengthInBits()>=8*u)break;if(s.put(t.PAD0,8),s.getLengthInBits()>=8*u)break;s.put(t.PAD1,8)}return t.createBytes(s,a)},t.createBytes=function(e,t){for(var o=0,i=0,r=0,a=new Array(t.length),s=new Array(t.length),l=0;l<t.length;l++){var c=t[l].dataCount,u=t[l].totalCount-c;i=Math.max(i,c),r=Math.max(r,u),a[l]=new Array(c);for(var d=0;d<a[l].length;d++)a[l][d]=255&e.buffer[d+o];o+=c;var h=g.getErrorCorrectPolynomial(u),f=new n(a[l],h.getLength()-1),m=f.mod(h);s[l]=new Array(h.getLength()-1);for(var d=0;d<s[l].length;d++){var p=d+m.getLength()-s[l].length;s[l][d]=p>=0?m.get(p):0}}for(var v=0,d=0;d<t.length;d++)v+=t[d].totalCount;for(var y=new Array(v),w=0,d=0;d<i;d++)for(var l=0;l<t.length;l++)d<a[l].length&&(y[w++]=a[l][d]);for(var d=0;d<r;d++)for(var l=0;l<t.length;l++)d<s[l].length&&(y[w++]=s[l][d]);return y};for(var c={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},u={L:1,M:0,Q:3,H:2},d={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},g={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){for(var t=e<<10;g.getBCHDigit(t)-g.getBCHDigit(g.G15)>=0;)t^=g.G15<<g.getBCHDigit(t)-g.getBCHDigit(g.G15);return(e<<10|t)^g.G15_MASK},getBCHTypeNumber:function(e){for(var t=e<<12;g.getBCHDigit(t)-g.getBCHDigit(g.G18)>=0;)t^=g.G18<<g.getBCHDigit(t)-g.getBCHDigit(g.G18);return e<<12|t},getBCHDigit:function(e){for(var t=0;0!=e;)t++,e>>>=1;return t},getPatternPosition:function(e){return g.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case d.PATTERN000:return(t+n)%2==0;case d.PATTERN001:return t%2==0;case d.PATTERN010:return n%3==0;case d.PATTERN011:return(t+n)%3==0;case d.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case d.PATTERN101:return t*n%2+t*n%3==0;case d.PATTERN110:
return(t*n%2+t*n%3)%2==0;case d.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new n([1],0),o=0;o<e;o++)t=t.multiply(new n([1,h.gexp(o)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case c.MODE_NUMBER:return 10;case c.MODE_ALPHA_NUM:return 9;case c.MODE_8BIT_BYTE:return 8;case c.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case c.MODE_NUMBER:return 12;case c.MODE_ALPHA_NUM:return 11;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case c.MODE_NUMBER:return 14;case c.MODE_ALPHA_NUM:return 13;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,o=0;o<t;o++)for(var i=0;i<t;i++){for(var r=0,a=e.isDark(o,i),s=-1;s<=1;s++)if(!(o+s<0||t<=o+s))for(var l=-1;l<=1;l++)i+l<0||t<=i+l||0==s&&0==l||a==e.isDark(o+s,i+l)&&r++;r>5&&(n+=3+r-5)}for(var o=0;o<t-1;o++)for(var i=0;i<t-1;i++){var c=0;e.isDark(o,i)&&c++,e.isDark(o+1,i)&&c++,e.isDark(o,i+1)&&c++,e.isDark(o+1,i+1)&&c++,0!=c&&4!=c||(n+=3)}for(var o=0;o<t;o++)for(var i=0;i<t-6;i++)e.isDark(o,i)&&!e.isDark(o,i+1)&&e.isDark(o,i+2)&&e.isDark(o,i+3)&&e.isDark(o,i+4)&&!e.isDark(o,i+5)&&e.isDark(o,i+6)&&(n+=40);for(var i=0;i<t;i++)for(var o=0;o<t-6;o++)e.isDark(o,i)&&!e.isDark(o+1,i)&&e.isDark(o+2,i)&&e.isDark(o+3,i)&&e.isDark(o+4,i)&&!e.isDark(o+5,i)&&e.isDark(o+6,i)&&(n+=40);for(var u=0,i=0;i<t;i++)for(var o=0;o<t;o++)e.isDark(o,i)&&u++;var d=Math.abs(100*u/t/t-50)/5;return n+=10*d}},h={glog:function(e){if(e<1)throw new Error("glog("+e+")");return h.LOG_TABLE[e]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return h.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},f=0;f<8;f++)h.EXP_TABLE[f]=1<<f;for(var f=8;f<256;f++)h.EXP_TABLE[f]=h.EXP_TABLE[f-4]^h.EXP_TABLE[f-5]^h.EXP_TABLE[f-6]^h.EXP_TABLE[f-8];for(var f=0;f<255;f++)h.LOG_TABLE[h.EXP_TABLE[f]]=f;n.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),o=0;o<this.getLength();o++)for(var i=0;i<e.getLength();i++)t[o+i]^=h.gexp(h.glog(this.get(o))+h.glog(e.get(i)));return new n(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=h.glog(this.get(0))-h.glog(e.get(0)),o=new Array(this.getLength()),i=0;i<this.getLength();i++)o[i]=this.get(i);for(var i=0;i<e.getLength();i++)o[i]^=h.gexp(h.glog(e.get(i))+t);return new n(o,0).mod(e)}},o.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],o.getRSBlocks=function(e,t){var n=o.getRsBlockTable(e,t);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var i=n.length/3,r=[],a=0;a<i;a++)for(var s=n[3*a+0],l=n[3*a+1],c=n[3*a+2],u=0;u<s;u++)r.push(new o(l,c));return r},o.getRsBlockTable=function(e,t){switch(t){case u.L:return o.RS_BLOCK_TABLE[4*(e-1)+0];case u.M:return o.RS_BLOCK_TABLE[4*(e-1)+1];case u.Q:return o.RS_BLOCK_TABLE[4*(e-1)+2];case u.H:return o.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},i.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var n=0;n<t;n++)this.putBit(1==(e>>>t-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var m=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],p=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){function t(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);for(var o in t)t.hasOwnProperty(o)&&n.setAttribute(o,t[o]);return n}var n=this._htOption,o=this._el,i=e.getModuleCount();Math.floor(n.width/i),Math.floor(n.height/i);this.clear();var r=t("svg",{viewBox:"0 0 "+String(i)+" "+String(i),width:"100%",height:"100%",fill:n.colorLight});r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),o.appendChild(r),r.appendChild(t("rect",{fill:n.colorLight,width:"100%",height:"100%"})),r.appendChild(t("rect",{fill:n.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;a<i;a++)for(var s=0;s<i;s++)if(e.isDark(a,s)){var l=t("use",{x:String(s),y:String(a)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),r.appendChild(l)}},e.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},e}(),v="svg"===document.documentElement.tagName.toLowerCase(),y=v?p:r()?function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function t(e,t){var n=this;if(n._fFail=t,n._fSuccess=e,null===n._bSupportDataURI){var o=document.createElement("img"),i=function(){n._bSupportDataURI=!1,n._fFail&&n._fFail.call(n)},r=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)};return o.onabort=i,o.onerror=i,o.onload=r,void(o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}n._bSupportDataURI===!0&&n._fSuccess?n._fSuccess.call(n):n._bSupportDataURI===!1&&n._fFail&&n._fFail.call(n)}if(this._android&&this._android<=2.1){var n=1/window.devicePixelRatio,o=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,t,i,r,a,s,l,c,u){if("nodeName"in e&&/img/i.test(e.nodeName))for(var d=arguments.length-1;d>=1;d--)arguments[d]=arguments[d]*n;else"undefined"==typeof c&&(arguments[1]*=n,arguments[2]*=n,arguments[3]*=n,arguments[4]*=n);o.apply(this,arguments)}}var i=function(e,t){this._bIsPainted=!1,this._android=a(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(e){var t=this._elImage,n=this._oContext,o=this._htOption,i=e.getModuleCount(),r=o.width/i,a=o.height/i,s=Math.round(r),l=Math.round(a);t.style.display="none",this.clear();for(var c=0;c<i;c++)for(var u=0;u<i;u++){var d=e.isDark(c,u),g=u*r,h=c*a;n.strokeStyle=d?o.colorDark:o.colorLight,n.lineWidth=1,n.fillStyle=d?o.colorDark:o.colorLight,n.fillRect(g,h,r,a),n.strokeRect(Math.floor(g)+.5,Math.floor(h)+.5,s,l),n.strokeRect(Math.ceil(g)-.5,Math.ceil(h)-.5,s,l)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&t.call(this,e)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},i}():function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){for(var t=this._htOption,n=this._el,o=e.getModuleCount(),i=Math.floor(t.width/o),r=Math.floor(t.height/o),a=['<table style="border:0;border-collapse:collapse;">'],s=0;s<o;s++){a.push("<tr>");for(var l=0;l<o;l++)a.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+r+"px;background-color:"+(e.isDark(s,l)?t.colorDark:t.colorLight)+';"></td>');a.push("</tr>")}a.push("</table>"),n.innerHTML=a.join("");var c=n.childNodes[0],u=(t.width-c.offsetWidth)/2,d=(t.height-c.offsetHeight)/2;u>0&&d>0&&(c.style.margin=d+"px "+u+"px")},e.prototype.clear=function(){this._el.innerHTML=""},e}();QRCode=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:u.H},"string"==typeof t&&(t={text:t}),t)for(var n in t)this._htOption[n]=t[n];"string"==typeof e&&(e=document.getElementById(e)),this._htOption.useSVG&&(y=p),this._android=a(),this._el=e,this._oQRCode=null,this._oDrawing=new y(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(e){this._oQRCode=new t(s(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=u}(),define("qrcode",function(){}),define("codeShow",["userData","qrcode"],function(e,t){function n(e){e===d?(document.getElementById("qrcode").style.display="none",document.getElementById("codeShowDigits").style.display="block",r("Double tap for QR Code")):(document.getElementById("codeShowDigits").style.display="none",document.getElementById("qrcode").style.display="block",r("Double tap for code in digits"))}function o(e,t){c=document.getElementById("codeShowDigitsCanvas").getContext("2d"),e<4?(c.clearRect(T+I*e,0,I,C),c.font=b,c.fillStyle=_,c.textAlign="center",c.fillText(t,k+I*e,S)):(c.clearRect(T+I*(e-4),C,I,C),c.font=b,c.fillStyle=_,c.textAlign="center",c.fillText(t,k+I*(e-4),S+C))}function i(){c=document.getElementById("codeShowHeaderCanvas").getContext("2d"),c.clearRect(0,0,p,v),c.font=B,c.fillStyle=x,c.textAlign="center",c.fillText("Your 8 digit code:",p/2,y)}function r(e){c=document.getElementById("codeShowMessageCanvas").getContext("2d"),c.clearRect(0,0,p,v),c.clearRect(0,280,p,w),c.font=B,c.fillStyle=x,c.textAlign="center",c.fillText(e,p/2,E)}function a(){var t=e.getCode();f=!0;for(var n,i=0;i<L;i++)n=Math.floor(t/Math.pow(10,7-i)),n-=10*Math.floor(n/10),o(i,n)}function s(){var t=e.getCode();m=!0,u=new QRCode("imageQR",{text:t.toString(),width:200,height:200,colorDark:"#000000",colorLight:"#ffffff"})}function l(){document.getElementById("mainPage").style.display="none",document.getElementById("codeShowPage").style.display="block",document.getElementById("backButtonInCodeShow").addEventListener("click",function(){document.getElementById("codeShowPage").style.display="none",document.getElementById("mainPage").style.display="block"}),f||a(),m||s(),i(),n(d)}var c,u,d=1,g=2,h=d,f=!1,m=!1,p=360,v=70,y=62,w=20,E=15,I=76,C=105,T=40,k=65,S=80,B="15px Arial",x="white",b="80px Arial",_="white",L=8;return{show:function(){l()},changePage:function(){h=h===d?g:d,n(h)}}}),define("settings",["effects","userData","profile","codeShow"],function(e,t,n,o){function i(){e.fade(r,a)}var r,a=5;return{create:function(e){r=document.getElementById("settingsPage"),document.getElementById("settingsSpace").addEventListener("click",function(){i()}),document.getElementById("reverseButton").addEventListener("click",function(){t.saveEvent("reverse"),t.setReverseStatus(!t.getReverseStatus()),e()}),document.getElementById("profileButton").addEventListener("click",function(){n.show()}),document.getElementById("logOutButton").addEventListener("click",function(){t.clear(),document.location.reload(!0)}),document.getElementById("codeShowButton").addEventListener("click",function(){o.show()}),document.getElementById("backButtonInSettings").addEventListener("click",function(){i()})},show:function(){r.style.visibility="visible",e.unfade(r,a)}}}),define("context",["userData","effects"],function(e,t){function n(){document.getElementById("popupWordCanvas").addEventListener("click",function(){t.fade(o,p)})}var o,i,r,a=!1,s=115,l=160,c=205,u=250,d=295,g=300,h=360,f="30px Arial",m="white",p=5;return{create:function(){r=document.getElementById("showContextPage"),o=document.getElementById("contextCanvas"),i=o.getContext("2d"),i.font=f,i.fillStyle=m,i.textAlign="center",n()},show:function(){var t=[],n=[],m=[],p=[],v=[],y=e.getWordPair(0).context,w=y.split(" "),E=1;e.getWord();console.log(w.length),w.length<=11?(E=2,i.font=f):w.length>20?i.font="20px Arial":i.font=f;for(var I=0;I<w.length;I++)1===E&&i.measureText(t+" "+w[I]).width<350?t+=" "+w[I]:E<=2&&i.measureText(n+" "+w[I]).width<340?(E=2,n+=" "+w[I]):E<=3&&i.measureText(m+" "+w[I]).width<320?(E=3,m+=" "+w[I]):E<=4&&i.measureText(p+" "+w[I]).width<320?(E=4,p+=" "+w[I]):(E=5,v+=" "+w[I]);r.style.visibility="visible",o.style.visibility="visible",o.style.opacity=1,r.style.opacity=.95,i.clearRect(0,0,h,g),i.fillText(t,h/2,s),i.fillText(n,h/2,l),i.fillText(m,h/2,c),i.fillText(p,h/2,u),i.fillText(v,h/2,d),a=!0},hide:function(){t.fade(o,p),a=!1},isShown:function(){return a}}}),define("menu",["effects","userData","profile","context"],function(e,t,n,o){function i(){e.fade(s,d)}function r(n,o){t.removeWord()?(e.feedbackByImage(n),t.saveWordPair(),t.sendEvents(),o()):(c.style.visibility="visible",c.style.opacity=1,u.clearRect(0,0,v,y/2),u.fillText("TOO FEW WORDS",v/2,g),u.fillText("there are too",v/2,h),u.fillText("few words left to",v/2,f),u.fillText("use this option",v/2,m),setTimeout(function(){e.fade(c,d)},p))}function a(a){document.getElementById("menuSpace").addEventListener("click",function(){i()}),document.getElementById("wrongTranslationButton").addEventListener("click",function(){t.saveEvent("wrongTranslation"),r(E,a)}),document.getElementById("learnedButton").addEventListener("click",function(){n.increaseWordsLearned(),n.userIsActive(),n.save(),t.saveEvent("learnedIt"),r(w,a)}),document.getElementById("contextInMenuButton").addEventListener("click",function(){t.saveEvent("showContext"),o.show()}),document.getElementById("backButtonInMenu").addEventListener("click",function(){i()}),document.getElementById("popupWordCanvas").addEventListener("click",function(){e.fade(c,d)}),document.getElementById("showContextPage").addEventListener("click",function(){e.fade(l,d),e.fade(c,d)})}var s,l,c,u,d=5,g=25,h=50,f=70,m=90,p=3e3,v=360,y=360,w="assets/right_icon_icon.png",E="assets/trash_icon.png",I="25px Arial",C="white";return{create:function(e){s=document.getElementById("menuPage"),l=document.getElementById("showContextPage"),c=document.getElementById("contextCanvas"),u=c.getContext("2d"),u.font=I,u.fillStyle=C,u.textAlign="center",a(e)},show:function(){s.style.visibility="visible",e.unfade(s,d)}}}),define("gui",["battery","userData","time","weather","fireworks","background","effects","settings","menu","profile","codeShow","context"],function(e,t,n,o,i,r,a,s,l,c,u,d){function g(e,t,n,o){I.font=o+C,I.fillStyle=S,I.textAlign="center",I.fillText(e,t,n)}function h(){document.getElementById("wordCanvas").style.backgroundImage="url('assets/background.png')",I.clearRect(0,0,B,x),g(t.getWord(),B/2,b,T);var e=document.getElementById("revealedPage");e.style.visibility="hidden"}function f(){I.clearRect(0,6,B,x),g(t.getWord(),B/2,b,T),g(t.getTranslation(),B/2,_,k),document.getElementById("wordCanvas").style.backgroundImage="url('assets/revealed_clicked_background.png')";var e=document.getElementById("revealedPage");e.style.visibility="visible"}function m(e){null===P?P=setTimeout(function(){P=null,r.change()},300):(clearTimeout(P),P=null,"time"===e?s.show():u.changePage())}function p(){c.userIsActive(),c.save(),t.saveEvent("right"),t.sendEvents();var e=L;t.updateWordPair(!0),t.saveWordPair(),a.feedbackByImage(e),h()}function v(){c.userIsActive(),c.save(),t.saveEvent("wrong"),t.sendEvents();var e=A;t.updateWordPair(!1),t.saveWordPair(),a.feedbackByImage(e),h()}function y(){document.getElementById("wordCanvas").addEventListener("click",function(e){t.saveEvent("reveal"),f(),t.saveClick(e.clientX,e.clientY,"reveal")}),document.getElementById("revealButton").addEventListener("click",function(e){t.saveEvent("reveal"),f(),d.hide(),d.isShown()&&d.hide(),t.saveClick(e.clientX,e.clientY,"reveal")}),document.getElementById("contextButton").addEventListener("click",function(e){t.saveEvent("showContext"),d.isShown()?d.hide():d.show(),t.saveClick(e.clientX,e.clientY,"showContext")}),document.getElementById("wrongCanvas").addEventListener("click",function(e){t.saveClick(e.clientX,e.clientY,"wrong"),v()}),document.getElementById("wrongButton").addEventListener("click",function(e){t.saveClick(e.clientX,e.clientY,"wrong"),v()}),document.getElementById("menuCanvas").addEventListener("click",function(e){t.saveClick(e.clientX,e.clientY,"menu"),l.show()}),document.getElementById("menuButton").addEventListener("click",function(e){t.saveClick(e.clientX,e.clientY,"menu"),l.show()}),document.getElementById("rightCanvas").addEventListener("click",function(e){t.saveClick(e.clientX,e.clientY,"right"),p()}),document.getElementById("rightButton").addEventListener("click",function(e){t.saveClick(e.clientX,e.clientY,"right"),p()}),document.getElementById("time").addEventListener("click",function(e){t.saveClick(e.clientX,e.clientY,"time"),m("time")}),document.getElementById("codeShowPage").addEventListener("click",function(e){t.saveClick(e.clientX,e.clientY,"time"),m("codeShowPage")})}function w(){c.refresh(),n.refresh(),r.rotate()}function E(){n.draw(),n.drawDate(),e.draw(),o.draw()}var I,C="px Arial",T=45,k=35,S="white",B=360,x=120,b=45,_=95,L="assets/right_icon_icon.png",A="assets/wrong_icon_icon.png",P=null;return{render:function(){w(),E()},create:function(e){I=e,c.create(),n.create(),s.create(h),l.create(h,f),r.create(),d.create(),o.create(),o.refresh(),h(),y()}}}),define("deviceListeners",["userData","weather","time","session"],function(e,t,n,o){function i(){document.getElementById("menuPage").style.visibility="hidden",document.getElementById("settingsPage").style.visibility="hidden",document.getElementById("profilePage").style.visibility="hidden"}function r(){e.sendClicks(),e.saveEvent("screenOn"),n.startUsageTracking(),t.refresh(),o.getWords(e.getCode(),!0)}function a(){o.updateWords(),e.saveEvent("screenOff"),i(),n.pauseUsageTracking(),n.resetSessionTime(),e.setSessionPopupShown(!1)}function s(){try{tizen.power.setScreenStateChangeListener(function(e,t){"SCREEN_NORMAL"===t&&"SCREEN_OFF"===e?r():a()})}catch(e){}}function l(){window.addEventListener("tizenhwkey",function(e){if("back"===e.keyName)try{}catch(e){}})}return function(){l(),s()}}),require(["login","session","gui","deviceListeners"],function(e,t,n,o){function i(){n.draw(),setTimeout(i,1e3)}function r(e){t.create(s,e);var r=t.getStatus();return"SUCCESS"!==r?r:(n.create(s),o(),i(),r)}var a=document.getElementById("wordCanvas"),s=a.getContext("2d");new e(r)}),define("main",function(){});